```markdown
# ESPECIFICAÃ‡ÃƒO TÃ‰CNICA: Sistema de Gerenciamento de HorÃ¡rios DisponÃ­veis

## ğŸ¯ OBJETIVO

Criar uma interface web no Replit que permita aos usuÃ¡rios **configurar horÃ¡rios disponÃ­veis** para agendamento de reuniÃµes de forma **100% personalizada**. Os horÃ¡rios configurados serÃ£o salvos no Supabase e consumidos pelo workflow do n8n para apresentar aos clientes durante o agendamento.

---

## ğŸ“Š ESTRUTURA DO BANCO DE DADOS (SUPABASE)

### **Tabela: `horarios_disponiveis`**

```sql
CREATE TABLE horarios_disponiveis (
  id UUID PRIMARY KEY DEFAULT uuid_generate_v4(),
  tenant_id TEXT NOT NULL,
  dia_semana INTEGER, -- 0=Domingo, 1=Segunda, 2=TerÃ§a, 3=Quarta, 4=Quinta, 5=Sexta, 6=SÃ¡bado, NULL=Todos os dias
  horario TIME NOT NULL,
  periodo TEXT, -- 'manhÃ£', 'tarde', 'noite'
  tipo_reuniao TEXT NOT NULL, -- 'online', 'presencial', 'ambos'
  ativo BOOLEAN DEFAULT true,
  created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW(),
  updated_at TIMESTAMP WITH TIME ZONE DEFAULT NOW()
);

-- Ãndices para performance
CREATE INDEX idx_horarios_tenant ON horarios_disponiveis(tenant_id);
CREATE INDEX idx_horarios_ativo ON horarios_disponiveis(ativo);
CREATE INDEX idx_horarios_dia ON horarios_disponiveis(dia_semana);

-- RLS (Row Level Security)
ALTER TABLE horarios_disponiveis ENABLE ROW LEVEL SECURITY;

CREATE POLICY "Users can view their own horarios"
  ON horarios_disponiveis FOR SELECT
  USING (tenant_id = current_setting('app.current_tenant'));

CREATE POLICY "Users can insert their own horarios"
  ON horarios_disponiveis FOR INSERT
  WITH CHECK (tenant_id = current_setting('app.current_tenant'));

CREATE POLICY "Users can update their own horarios"
  ON horarios_disponiveis FOR UPDATE
  USING (tenant_id = current_setting('app.current_tenant'));

CREATE POLICY "Users can delete their own horarios"
  ON horarios_disponiveis FOR DELETE
  USING (tenant_id = current_setting('app.current_tenant'));
```

---

## ğŸ¨ INTERFACE WEB (REPLIT)

### **PÃ¡gina: `/configurar-horarios`**

#### **REQUISITOS FUNCIONAIS**

1. **AutenticaÃ§Ã£o**
   - UsuÃ¡rio deve estar logado
   - Identificar `tenant_id` do usuÃ¡rio logado

2. **VisualizaÃ§Ã£o de HorÃ¡rios Configurados**
   - Listar todos os horÃ¡rios cadastrados do `tenant_id` atual
   - Organizar por dia da semana e horÃ¡rio
   - Mostrar status (ativo/inativo)
   - Permitir filtrar por tipo de reuniÃ£o

3. **Adicionar Novo HorÃ¡rio (100% PersonalizÃ¡vel)**
   - **Dia da Semana**: 
     - Checkbox para cada dia (Seg, Ter, Qua, Qui, Sex, SÃ¡b, Dom)
     - OpÃ§Ã£o "Todos os dias" (salva como `dia_semana = NULL`)
   - **HorÃ¡rio**: 
     - Input tipo `time` (HH:MM)
     - Permitir adicionar mÃºltiplos horÃ¡rios de uma vez
   - **PerÃ­odo** (auto-detectado ou manual):
     - ManhÃ£ (06:00 - 11:59)
     - Tarde (12:00 - 17:59)
     - Noite (18:00 - 05:59)
   - **Tipo de ReuniÃ£o**:
     - Radio button: Online / Presencial / Ambos
   - **BotÃ£o "Adicionar HorÃ¡rio"**

4. **Editar HorÃ¡rio Existente**
   - Clicar em horÃ¡rio listado abre modal de ediÃ§Ã£o
   - Permitir alterar qualquer campo
   - BotÃ£o "Salvar AlteraÃ§Ãµes"

5. **Excluir HorÃ¡rio**
   - BotÃ£o de lixeira em cada horÃ¡rio
   - ConfirmaÃ§Ã£o antes de excluir
   - Soft delete (marcar `ativo = false`) OU hard delete

6. **Ativar/Desativar HorÃ¡rio**
   - Toggle switch em cada horÃ¡rio
   - Atualiza campo `ativo` no banco

7. **VisualizaÃ§Ã£o em Grade Semanal**
   - CalendÃ¡rio visual mostrando horÃ¡rios por dia da semana
   - Cores diferentes para online/presencial/ambos

---

## ğŸ’» IMPLEMENTAÃ‡ÃƒO TÃ‰CNICA

### **Stack Sugerida**
- **Frontend**: React ou HTML+JavaScript
- **Backend**: Node.js (Express) ou Python (Flask)
- **Database**: Supabase (PostgreSQL)
- **Styling**: Tailwind CSS ou Bootstrap

---

### **API ENDPOINTS (Backend Replit)**

#### **1. GET `/api/horarios`**
Retorna todos os horÃ¡rios do tenant logado

**Response:**
```json
{
  "success": true,
  "data": [
    {
      "id": "uuid",
      "tenant_id": "dev-daviemericko_gmail_com",
      "dia_semana": 1,
      "horario": "09:00:00",
      "periodo": "manhÃ£",
      "tipo_reuniao": "ambos",
      "ativo": true,
      "created_at": "2026-01-27T10:00:00Z"
    }
  ]
}
```

---

#### **2. POST `/api/horarios`**
Cria um novo horÃ¡rio

**Request Body:**
```json
{
  "dias_semana": [1, 2, 3, 4, 5], // Array de dias OU null para "todos os dias"
  "horario": "09:00",
  "tipo_reuniao": "ambos"
}
```

**LÃ³gica:**
1. Detectar perÃ­odo automaticamente baseado no horÃ¡rio
2. Se `dias_semana = null`, criar 1 registro com `dia_semana = NULL`
3. Se `dias_semana = [1,2,3]`, criar 3 registros (um para cada dia)
4. Salvar `tenant_id` do usuÃ¡rio logado

**Response:**
```json
{
  "success": true,
  "message": "5 horÃ¡rios criados com sucesso",
  "data": [...]
}
```

---

#### **3. PUT `/api/horarios/:id`**
Atualiza um horÃ¡rio existente

**Request Body:**
```json
{
  "dia_semana": 2,
  "horario": "10:00",
  "tipo_reuniao": "online",
  "ativo": true
}
```

**ValidaÃ§Ãµes:**
- Verificar se `id` pertence ao `tenant_id` logado
- Recalcular perÃ­odo se horÃ¡rio mudou

---

#### **4. DELETE `/api/horarios/:id`**
Exclui um horÃ¡rio

**OpÃ§Ãµes:**
- **Soft Delete** (recomendado): `UPDATE horarios_disponiveis SET ativo = false WHERE id = :id`
- **Hard Delete**: `DELETE FROM horarios_disponiveis WHERE id = :id`

---

#### **5. PATCH `/api/horarios/:id/toggle`**
Ativa/desativa um horÃ¡rio

**Request Body:**
```json
{
  "ativo": false
}
```

---

## ğŸ¨ EXEMPLOS DE UI/UX

### **Tela Principal**

```
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘  ğŸ“… CONFIGURAR HORÃRIOS DISPONÃVEIS                        â•‘
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
â•‘                                                            â•‘
â•‘  [+ Adicionar Novo HorÃ¡rio]                   [Grade Semanal] â•‘
â•‘                                                            â•‘
â•‘  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â•‘
â•‘  â”‚ HORÃRIOS CADASTRADOS                                â”‚  â•‘
â•‘  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â•‘
â•‘  â”‚ Segunda-feira                                       â”‚  â•‘
â•‘  â”‚  â€¢ 09:00 - ManhÃ£ (Ambos) [â—][âœï¸][ğŸ—‘ï¸]              â”‚  â•‘
â•‘  â”‚  â€¢ 14:00 - Tarde (Online) [â—][âœï¸][ğŸ—‘ï¸]             â”‚  â•‘
â•‘  â”‚                                                     â”‚  â•‘
â•‘  â”‚ TerÃ§a-feira                                         â”‚  â•‘
â•‘  â”‚  â€¢ 09:00 - ManhÃ£ (Ambos) [â—‹][âœï¸][ğŸ—‘ï¸]              â”‚  â•‘
â•‘  â”‚  â€¢ 20:00 - Noite (Presencial) [â—][âœï¸][ğŸ—‘ï¸]         â”‚  â•‘
â•‘  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
```

---

### **Modal: Adicionar HorÃ¡rio**

```
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘  â• ADICIONAR NOVO HORÃRIO                                 â•‘
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
â•‘                                                            â•‘
â•‘  ğŸ“† Dias da Semana:                                        â•‘
â•‘  â˜ Todos os dias                                          â•‘
â•‘  â˜‘ Seg  â˜‘ Ter  â˜‘ Qua  â˜‘ Qui  â˜‘ Sex  â˜ SÃ¡b  â˜ Dom        â•‘
â•‘                                                            â•‘
â•‘  â° HorÃ¡rio:                                               â•‘
â•‘  [09:00] â† (input type="time")                           â•‘
â•‘                                                            â•‘
â•‘  ğŸ“ Tipo de ReuniÃ£o:                                       â•‘
â•‘  â—‰ Ambos    â—‹ Somente Online    â—‹ Somente Presencial     â•‘
â•‘                                                            â•‘
â•‘  [Cancelar]                        [Adicionar HorÃ¡rio]    â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
```

---

## ğŸ”„ FLUXO DE DADOS

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  UsuÃ¡rio acessa â”‚
â”‚  /configurar-   â”‚
â”‚  horarios       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Frontend chama  â”‚
â”‚ GET /api/       â”‚
â”‚ horarios        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Backend busca   â”‚
â”‚ no Supabase     â”‚
â”‚ WHERE tenant_id â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Renderiza lista â”‚
â”‚ de horÃ¡rios     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ UsuÃ¡rio clica   â”‚
â”‚ "Adicionar"     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ POST /api/      â”‚
â”‚ horarios        â”‚
â”‚ {dias, hora}    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Backend cria    â”‚
â”‚ registros no    â”‚
â”‚ Supabase        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ n8n workflow    â”‚
â”‚ consome dados   â”‚
â”‚ automaticamente â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## âœ… VALIDAÃ‡Ã•ES OBRIGATÃ“RIAS

1. **HorÃ¡rio vÃ¡lido**: 00:00 a 23:59
2. **Pelo menos 1 dia selecionado** (a menos que seja "todos os dias")
3. **Tipo de reuniÃ£o obrigatÃ³rio**
4. **NÃ£o permitir duplicatas**: mesmo `tenant_id` + `dia_semana` + `horario`
5. **tenant_id sempre do usuÃ¡rio logado** (nunca confiar no frontend)

---

## ğŸ¯ CASOS DE USO

### **Caso 1: Empresa quer horÃ¡rios fixos todos os dias**
```
Input:
- Todos os dias: âœ“
- HorÃ¡rios: 09:00, 14:00, 20:00
- Tipo: Ambos

Resultado no DB:
id | tenant_id | dia_semana | horario | periodo | tipo_reuniao
---|-----------|------------|---------|---------|-------------
1  | tenant_x  | NULL       | 09:00   | manhÃ£   | ambos
2  | tenant_x  | NULL       | 14:00   | tarde   | ambos
3  | tenant_x  | NULL       | 20:00   | noite   | ambos
```

---

### **Caso 2: Terapeuta quer horÃ¡rios diferentes por dia**
```
Input:
- Segunda: 09:00, 14:00 (Ambos)
- Quarta: 10:00, 15:00 (Online)
- Sexta: 08:00, 18:00 (Presencial)

Resultado no DB:
id | tenant_id | dia_semana | horario | periodo | tipo_reuniao
---|-----------|------------|---------|---------|-------------
1  | tenant_y  | 1          | 09:00   | manhÃ£   | ambos
2  | tenant_y  | 1          | 14:00   | tarde   | ambos
3  | tenant_y  | 3          | 10:00   | manhÃ£   | online
4  | tenant_y  | 3          | 15:00   | tarde   | online
5  | tenant_y  | 5          | 08:00   | manhÃ£   | presencial
6  | tenant_y  | 5          | 18:00   | noite   | presencial
```

---

### **Caso 3: Apenas online de manhÃ£, presencial Ã  tarde**
```
Input:
- Seg a Sex: 09:00 (Online), 14:00 (Presencial)

Resultado no DB:
10 registros (5 dias Ã— 2 horÃ¡rios)
```

---

## ğŸ”’ SEGURANÃ‡A

1. **AutenticaÃ§Ã£o obrigatÃ³ria** em todas as rotas
2. **Row Level Security (RLS)** no Supabase
3. **Validar tenant_id no backend** - nunca confiar no frontend
4. **CORS configurado** apenas para domÃ­nios autorizados
5. **Rate limiting** para evitar spam

---

## ğŸ“± RESPONSIVIDADE

- Mobile-first design
- Grade semanal adaptÃ¡vel (colapsa em accordion no mobile)
- Modals fullscreen em telas pequenas

---

## ğŸš€ ENTREGÃVEIS

1. âœ… Tabela `horarios_disponiveis` criada no Supabase
2. âœ… API REST completa (`GET`, `POST`, `PUT`, `DELETE`, `PATCH`)
3. âœ… Interface web funcional em `/configurar-horarios`
4. âœ… DocumentaÃ§Ã£o de uso para o cliente final
5. âœ… Testes de integraÃ§Ã£o com n8n workflow

---

## ğŸ“ OBSERVAÃ‡Ã•ES IMPORTANTES

- Os horÃ¡rios configurados aqui serÃ£o **automaticamente consumidos** pelo workflow do n8n
- Amanda (a IA) apresentarÃ¡ esses horÃ¡rios formatados ao cliente durante o agendamento
- O sistema deve ser **100% autoexplicativo** para o usuÃ¡rio final
- Permitir **exportar/importar** configuraÃ§Ãµes em JSON (futuro)

---

**TECNOLOGIAS REQUERIDAS:**
- Node.js v18+
- Supabase Client Library
- Express.js (backend)
- React ou Vanilla JS (frontend)
- Tailwind CSS (styling)

**PRAZO SUGERIDO:** 5-7 dias Ãºteis

**PRIORIDADE:** Alta (bloqueante para agendamentos personalizados)
```

---

Este prompt contÃ©m **TUDO** que o desenvolvedor do Replit precisa saber para criar o sistema completo! ğŸš€