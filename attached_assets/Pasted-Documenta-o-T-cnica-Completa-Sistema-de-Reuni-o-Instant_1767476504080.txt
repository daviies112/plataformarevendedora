DocumentaÃ§Ã£o TÃ©cnica Completa: Sistema de ReuniÃ£o InstantÃ¢nea
ğŸ“‹ Ãndice
VisÃ£o Geral do Fluxo
Passo 1: CriaÃ§Ã£o da ReuniÃ£o (Dashboard)
Passo 2: Modal de Sucesso
Passo 3: Interface de VÃ­deo (Sala)
Passo 4: GravaÃ§Ã£o da ReuniÃ£o
Passo 5: VisualizaÃ§Ã£o de GravaÃ§Ãµes
Arquitetura Backend
Checklist de ReplicaÃ§Ã£o
VisÃ£o Geral do Fluxo
Clica 'ReuniÃ£o InstantÃ¢nea'
Clica 'Participar agora'
Interface de VÃ­deo
Clica Gravar
Clica Parar
Webhook/Sync
Clica Assistir
Dashboard
API cria sala 100ms
Modal de Sucesso
Sala de ReuniÃ£o
Meeting100ms Component
Inicia GravaÃ§Ã£o
Para GravaÃ§Ã£o
Status: Completed
PÃ¡gina GravaÃ§Ãµes
Player de VÃ­deo
Passo 1: CriaÃ§Ã£o da ReuniÃ£o
Dashboard (
client/src/pages/Dashboard.tsx
)
BotÃ£o Verde "ReuniÃ£o InstantÃ¢nea":

<Button 
  onClick={handleInstantMeeting} 
  disabled={isCreatingInstant}
  className="gap-2 bg-green-600 hover:bg-green-700"
>
  {isCreatingInstant ? (
    <Loader2 className="h-4 w-4 animate-spin" />
  ) : (
    <Zap className="h-4 w-4" />
  )}
  ReuniÃ£o InstantÃ¢nea
</Button>
Handler:

const handleInstantMeeting = async () => {
  try {
    // Chama API para criar reuniÃ£o
    const meeting = await createInstantMeeting({ titulo: 'ReuniÃ£o InstantÃ¢nea' });
    
    // Armazena dados da reuniÃ£o criada
    setCreatedMeeting({
      id: meeting.id,
      linkReuniao: meeting.linkReuniao,
      titulo: meeting.titulo,
    });
    
    // Abre modal de sucesso
    setShowMeetingModal(true);
  } catch (error) {
    toast({ title: "Erro", description: error.message });
  }
};
Backend Endpoint (
server/routes.ts
):

app.post("/api/reunioes/instantanea", requireAuth, requireTenant, async (req, res) => {
  // 1. Criar sala no 100ms
  const sala = await criarSala(
    `instantanea-${Date.now()}`,
    hmsTemplateId,
    hmsAccessKey,
    hmsAppSecret
  );
  
  // 2. Gerar link pÃºblico
  const linkReuniao = `https://${domain}/reuniao/${tenant.slug}/${sala.id}`;
  
  // 3. Salvar no banco
  const [novaReuniao] = await db.insert(reunioes).values({
    titulo: 'ReuniÃ£o InstantÃ¢nea',
    roomId100ms: sala.id,
    linkReuniao,
    status: 'em_andamento',
    dataInicio: new Date(),
    dataFim: new Date(Date.now() + 60 * 60000), // +60min
  }).returning();
  
  return res.status(201).json(novaReuniao);
});
Passo 2: Modal de Sucesso
InstantMeetingModal (
client/src/components/InstantMeetingModal.tsx
)
Design do Modal:

âœ… Ãcone de check verde
ğŸ“‹ Campo de input com o link (read-only)
ğŸ“‹ BotÃ£o "Copiar" ao lado do input
ğŸ‘¥ BotÃ£o "Convidar" (abre formulÃ¡rio de email)
ğŸ”µ BotÃ£o principal "Participar agora" (azul, grande)
CÃ³digo do BotÃ£o Principal:

<Button 
  onClick={handleJoinNow} 
  className="w-full h-14 rounded-2xl bg-blue-600 hover:bg-blue-700 shadow-lg"
>
  Participar agora
  <ArrowRight className="h-5 w-5" />
</Button>
Handler de ParticipaÃ§Ã£o:

const handleJoinNow = () => {
  if (meeting?.linkReuniao) {
    // Abre link em nova aba
    const url = meeting.linkReuniao.startsWith('http') 
      ? meeting.linkReuniao 
      : `${window.location.origin}${meeting.linkReuniao}`;
    
    window.open(url, "_blank");
    onClose();
  }
};
Passo 3: Interface de VÃ­deo
Meeting100ms Component (
client/src/components/Meeting100ms.tsx
)
Estrutura da Interface:

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Header (Logo + Status de GravaÃ§Ã£o)     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                         â”‚
â”‚   Grid de VÃ­deos (PeerVideo)           â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”                   â”‚
â”‚   â”‚Peer 1â”‚  â”‚Peer 2â”‚                   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”˜                   â”‚
â”‚                                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Footer (Controles)                      â”‚
â”‚ [ğŸ¤] [ğŸ“¹] [ğŸ–¥ï¸] [âš«] [Sair]             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
Componente PeerVideo (linhas 36-112):

function PeerVideo({ peer, config, totalPeers }) {
  const { videoRef } = useVideo({ trackId: peer.videoTrack });
  const isVideoOff = !peer.videoTrack;
  return (
    <Card className="relative aspect-video bg-zinc-900">
      {/* Avatar (quando vÃ­deo estÃ¡ off) */}
      <div className="absolute inset-0 flex items-center justify-center">
        <div className="w-20 h-20 rounded-full bg-blue-600 text-white">
          {peer.name?.charAt(0).toUpperCase()}
        </div>
      </div>
      {/* VÃ­deo */}
      <video
        ref={videoRef}
        autoPlay
        muted={peer.isLocal}
        playsInline
        className="absolute inset-0 w-full h-full object-cover"
      />
      {/* Nome do participante */}
      <div className="absolute bottom-3 left-3 px-3 py-1.5 rounded-lg bg-black/60 text-white">
        {peer.name} {peer.isLocal && "(VocÃª)"}
        {!peer.audioTrack && <MicOff className="w-3 h-3 text-red-500" />}
      </div>
    </Card>
  );
}
Header com Indicador de GravaÃ§Ã£o (linhas 454-486):

<head...